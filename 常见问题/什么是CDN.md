# CDN: 全称 Content Delivery Network,即内容分发网络。

CDN 是一组分布在多个不同地理位置的 web 服务器，用于更加有效的向用户发布内容

摘录一个形象的比喻,来理解 CDN 是什么。

> 10 年前，还没有火车票代售点一说，12306.cn 更是无从说起。那时候火车票还只能在火车站的售票大厅购买，而我所在的小县城并不通火车，火车票都要去市里的火车站购买，而从我家到县城再到市里，来回就是 4 个小时车程，简直就是浪费生命。后来就好了，小县城里出现了火车票代售点，甚至乡镇上也有了代售点，可以直接在代售点购买火车票，方便了不少，全市人民再也不用在一个点苦逼的排队买票了。

- 简单的理解 CDN 就是这些代售点(缓存服务器)的承包商,他为买票者提供了便利,帮助他们在最近的地方(最近的 CDN 节点)用最短的时间(最短的请求时间)买到票(拿到资源),这样去火车站售票大厅排队的人也就少了。也就减轻了售票大厅的压力(起到分流作用,减轻服务器负载压力)。
  用户在浏览网站的时候，CDN 会选择一个离用户最近的 CDN 边缘节点来响应用户的请求，这样海南移动用户的请求就不会千里迢迢跑到北京电信机房的服务器（假设源站部署在北京电信机房）上了。

- 网站通常将其所有的服务器都放在同一个地方，当用户群增加时，公司就必须在多个地理位置不同的服务器上部署内容
  为了缩短 http 请求的时间，我们应该把大量的静态资源放置的离用户近一点。

# 基本思路：

1. 尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。

2. 通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，
3. CDN 系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息
4. 将用户的请求重新导向离用户最近的服务节点上。

# 基础架构：最简单的 CDN 网络由一个 DNS 服务器和几台缓存服务器组成

1. 用户输入的 url，会经过 DNS 解析“翻译”成对应的 ip 地址，从而找到 CDN 专用的服务器。
2. CDN“拿到”用户的 IP 地址，随后和区域负载均衡设备配合，选择一台用户所属区域的区域负载均衡设备，告诉用户向这台设备发起请求。
3. 上述步骤中的“选择”依据

   (1).选择的依据包括：根据用户 IP 地址，判断哪一台服务器距用户最近；

   (2).根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需内容；

   (3).查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。
