# https与http的区别?

HTTPS 要比 HTTPS 多了 secure 安全性这个概念，实际上， HTTPS 并不是一个新的应用层协议，它其实就是 HTTP + TLS/SSL 协议组合而成，而安全性的保证正是 SSL/TLS 所做的工作。

**「SSL」**
安全套接层（Secure Sockets Layer）


**「TLS」**
（传输层安全，Transport Layer Security）

现在主流的版本是 TLS/1.2, 之前的 TLS1.0、TLS1.1 都被认为是不安全的，在不久的将来会被完全淘汰。

**「HTTPS 就是身披了一层 SSL 的 HTTP」。**

![](../static/https1.png)

- 那么区别有哪些呢👇
 1. HTTP 是明文传输协议，HTTPS 协议是由 SSL+HTTP 协议构建的可进行加密传输、身份认证的网络协议，比 HTTP 协议安全。
   
 2. HTTPS比HTTP更加安全，对搜索引擎更友好，利于SEO,谷歌、百度优先索引HTTPS网页。
   
 3. HTTPS标准端口443，HTTP标准端口80。
   
 4. HTTPS需要用到SSL证书，而HTTP不用。

# 介绍一个HTTPS工作原理

 - 我们可以把HTTPS理解成「HTTPS = HTTP + SSL/TLS」
  
 - TLS/SSL 的功能实现主要依赖于三类基本算法：**散列函数** 、**对称加密**和**非对称加密**，其利用非对称加密实现身份认证和密钥协商，对称加密算法采用协商的密钥对数据加密，基于散列函数验证信息的完整性。

##  对称加密

加密和解密用同一个秘钥的加密方式叫做对称加密。Client客户端和Server端共用一套密钥，这样子的加密过程似乎很让人理解，但是随之会产生一些问题。

- 「问题一:」 WWW万维网有许许多多的客户端，不可能都用秘钥A进行信息加密，这样子很不合理，所以解决办法就是使用一个客户端使用一个密钥进行加密。

- 「问题二:「既然不同的客户端使用不同的密钥，那么」对称加密的密钥如何传输？」 那么解决的办法只能是「一端生成一个秘钥，然后通过HTTP传输给另一端」，那么这样子又会产生新的问题。
- 
- 「问题三:」 这个传输密钥的过程，又如何保证加密？「如果被中间人拦截，密钥也会被获取,」 那么你会说对密钥再进行加密，那又怎么保存对密钥加密的过程，是加密的过程？
  
- 到这里，我们似乎想明白了，使用对称加密的方式，行不通，所以我们需要采用非对称加密👇

## 非对称加密
通过上面的分析，对称加密的方式行不通，那么我们来梳理一下非对称加密。采用的算法是RSA，所以在一些文章中也会看见「传统RSA握手」，基于现在TLS主流版本是1.2，所以接下来梳理的是「TLS/1.2握手过程」

非对称加密中，我们需要明确的点是👇

 1.  有一对秘钥，「公钥」和「私钥」。
 2.  公钥加密的内容，只有私钥可以解开，私钥加密的内容，所有的公钥都可以解开，这里说的「公钥都可以解开，指的是一对秘钥」。
 3.  公钥可以发送给所有的客户端，私钥只保存在服务器端

## RSA算法（最典型的非对称加密算法）

   - 想要彻底搞懂RSA，需要了解数论的知识，全部推导过程 RSA加密算法[2]。本文简单介绍思路：使用两个超大质数以及其乘积作为生成公钥和私钥的材料，想要从公钥推算出私钥是非常困难的（需要对超大数因式分解为两个很大质数的乘积）。目前被破解的最长RSA密钥是768个二进制位。也就是说，长度超过768位的密钥，还无法破解（至少没人公开宣布）。因此可以认为，1024位的RSA密钥基本安全，2048位的密钥极其安全。

   - 优点：强度高、安全性强于对称加密算法、无需传递私钥导致没有密钥泄露风险
   - 缺点：计算量大、速度慢
   - 适用场景：
        1. 适用于需要密钥交换的场景，如互联网应用，无法事先约定密钥。可以与对称加密算法结合：
        2. 利用非对称加密算法安全性较好的特点来传递对称加密算法的密钥。
        3. 利用对称加密算法加解密速度快的特点，进行数据内容比较大的加密场景的加密。如HTTPS。

# 介绍 HTTPS 握手过程

- 客户端请求服务器，并告诉服务器自身支持的加密算法以及密钥长度等信息
- 服务器响应公钥和服务器证书
- 客户端验证证书是否合法，然后生成一个会话密钥，并用服务器的公钥加密密钥，把加密的结果通过请求发送给服务器
- 服务器使用私钥解密被加密的会话密钥并保存起来，然后使用会话密钥加密消息响应给客户端，表示自己已经准备就绪
- 客户端使用会话密钥解密消息，知道了服务器已经准备就绪。
- 后续客户端和服务器使用会话密钥加密信息传递消息

# 介绍 SSL 和 TLS

它们都是用于保证传输安全的协议，介于传输层和应用层之间，TLS 是 SSL 的升级版。
它们的基本流程一致：

客户端向服务器端索要公钥，并使用数字证书验证公钥。
客户端使用公钥加密会话密钥，服务端用私钥解密会话密钥，于是得到一个双方都认可的会话密钥
传输的数据使用会话密钥加密，然后再传输，接收消息方使用会话密钥解密得到原始数据

# 介绍下 HTTPS 中间人攻击

针对 HTTPS 攻击主要有 SSL 劫持攻击和 SSL 剥离攻击两种。

- SSL 劫持攻击是指攻击者劫持了客户端和服务器之间的连接，将服务器的合法证书替换为伪造的证书，从而获取客户端和服务器之间传递的信息。这种方式一般容易被用户发现，浏览器会明确的提示证书错误，但某些用户安全意识不强，可能会点击继续浏览，从而达到攻击目的。

- SSL 剥离攻击是指攻击者劫持了客户端和服务器之间的连接，攻击者保持自己和服务器之间的 HTTPS 连接，但发送给客户端普通的 HTTP 连接，由于 HTTP 连接是明文传输的，即可获取客户端传输的所有明文数据。

# HTTPS 握手过程中，客户端如何验证证书的合法性

- 校验证书的颁发机构是否受客户端信任。
- 通过 CRL 或 OCSP 的方式校验证书是否被吊销。
- 对比系统时间，校验证书是否在有效期内。
- 通过校验对方是否存在证书的私钥，判断证书的网站域名是否与证书颁发的域名一致
